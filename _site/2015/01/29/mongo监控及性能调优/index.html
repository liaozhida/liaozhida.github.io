<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>mongo监控及性能调优 - 志达的博客 | Paraller's Blog</title>

    <link rel="canonical" href="http://localhost:4000/2015/01/29/mongo%E7%9B%91%E6%8E%A7%E5%8F%8A%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="http://cdn.staticfile.org/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Paraller's Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    
                    <li>
                        <a href="/tags/">Tags</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/post-bg-2015.jpg" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/img/post-bg-2015.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#mongo" title="mongo">mongo</a>
                        
                    </div>
                    <h1>mongo监控及性能调优</h1>
                    
                    
                    <h2 class="subheading"></h2>
                    
                    <span class="meta">Posted by zhidaliao on January 29, 2015</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

				<h2 id="监控策略">监控策略</h2>

<p>mongo监控的策略主要有以下两种:</p>

<ul>
  <li>一系列的工具能够报告实时信息</li>
  <li>数据库命令能够返回当前数据库的详细精确信息</li>
</ul>

<h3 id="mongostat">mongostat</h3>

<p>mongostat captures and returns the counts of database operations by type (e.g. insert, query, update, delete, etc.). These counts report on the load distribution on the server.</p>

<p>Use mongostat to understand the distribution of operation types and to inform capacity planning. See the <a href="https://docs.mongodb.com/manual/reference/program/mongostat/">mongostat manual</a> for details.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>root@db94dfee43b5:/# mongostat &lt;sleeptime&gt;
insert query update delete getmore command dirty used flushes vsize   res qrw arw net_in net_out conn                time
    *0    *0     *0     *0       0     2|0  0.0% 0.1%       0  270M 59.0M 0|0 0|0   160b   45.5k    2 Aug 29 08:48:07.749
    *0    *0     *0     *0       0     1|0  0.0% 0.1%       0  270M 59.0M 0|0 0|0   157b   44.8k    2 Aug 29 08:48:08.749
</code></pre>
</div>

<p>每个字段代表的意思</p>

<ul>
  <li>
    <p>inserts
The number of objects inserted into the database per second. If followed by an asterisk (e.g. *), the datum refers to a replicated operation.</p>
  </li>
  <li>
    <p>query
The number of query operations per second.</p>
  </li>
  <li>
    <p>update
The number of update operations per second.</p>
  </li>
  <li>
    <p>delete
The number of delete operations per second.</p>
  </li>
  <li>
    <p>getmore
The number of get more (i.e. cursor batch) operations per second.</p>
  </li>
  <li>
    <p>command
The number of commands per second. On slave and secondary systems, mongostat presents two values separated by a pipe character (e.g. |), in the form of local|replicated commands.</p>
  </li>
  <li>
    <p>flushes
Changed in version 3.0.
For the WiredTiger Storage Engine, flushes refers to the number of WiredTiger checkpoints triggered between each polling interval.
For the MMAPv1 Storage Engine, flushes represents the number of fsync operations per second.</p>
  </li>
  <li>
    <p>dirty
New in version 3.0.
Only for WiredTiger Storage Engine. The percentage of the WiredTiger cache with dirty bytes, calculated by wiredTiger.cache.tracked dirty bytes in the cache / wiredTiger.cache.maximum bytes configured.</p>
  </li>
  <li>
    <p>used
New in version 3.0.
Only for WiredTiger Storage Engine. The percentage of the WiredTiger cache that is in use, calculated by wiredTiger.cache.bytes currently in the cache / wiredTiger.cache.maximum bytes configured.</p>
  </li>
  <li>
    <p>mapped
Changed in version 3.0.
Only for MMAPv1 Storage Engine. The total amount of data mapped in megabytes. This is the total data size at the time of the last mongostat call.</p>
  </li>
  <li>
    <p>vsize
The amount of virtual memory in megabytes used by the process at the time of the last mongostat call.</p>
  </li>
  <li>
    <p>res
The amount of resident memory in megabytes used by the process at the time of the last mongostat call.</p>
  </li>
  <li>
    <p>faults
Changed in version 3.0.
Only for MMAPv1 Storage Engine. The number of page faults per second.
Changed in version 2.1: Before version 2.1, this value was only provided for MongoDB instances running on Linux hosts.</p>
  </li>
  <li>
    <p>lr
New in version 3.2.
Only for MMAPv1 Storage Engine. The percentage of read lock acquisitions that had to wait. mongostat displays lr|lw if a lock acquisition waited.</p>
  </li>
  <li>
    <p>lw
New in version 3.2.
Only for MMAPv1 Storage Engine. The percentage of write lock acquisitions that had to wait. mongostat displays lr|lw if a lock acquisition waited.</p>
  </li>
  <li>
    <p>locked
Changed in version 3.0: Only appears when mongostat runs against pre-3.0 versions of MongoDB instances.
The percent of time in a global write lock.</p>
  </li>
  <li>
    <p>idx miss
Changed in version 3.0.
Only for MMAPv1 Storage Engine. The percent of index access attempts that required a page fault to load a btree node. This is a sampled value.</p>
  </li>
  <li>
    <p>qr
The length of the queue of clients waiting to read data from the MongoDB instance.</p>
  </li>
  <li>
    <p>qw
The length of the queue of clients waiting to write data from the MongoDB instance.</p>
  </li>
  <li>
    <p>ar
The number of active clients performing read operations.</p>
  </li>
  <li>
    <p>aw
The number of active clients performing write operations.</p>
  </li>
  <li>
    <p>netIn
The amount of network traffic, in bytes, received by the MongoDB instance.
This includes traffic from mongostat itself.</p>
  </li>
  <li>
    <p>conn
The total number of open connections.</p>
  </li>
  <li>
    <p>set
The name, if applicable, of the replica set.</p>
  </li>
</ul>

<p><strong>Add Fields to mongostat Output</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>root@db94dfee43b5:/# mongostat -O 'host,version,network.numRequests=network requests'
insert query update delete getmore command dirty used flushes vsize   res qrw arw net_in net_out conn                time            host version network requests
    *0    *0     *0     *0       0     2|0  0.0% 0.1%       0  271M 59.0M 0|0 0|0   158b   44.8k    2 Aug 29 09:45:11.850 localhost:27017   3.4.2             6319
    *0    *0     *0     *0       0     2|0  0.0% 0.1%       0  271M 59.0M 0|0 0|0   158b   44.9k    2 Aug 29 09:45:12.847 localhost:27017   3.4.2             6323
    *0    *0     *0     *0       0     1|0  0.0% 0.1%       0  271M 59.0M 0|0 0|0   157b   44.7k    2 Aug 29 09:45:13.849 localhost:27017   3.4.2             6327
    *0    *0     *0     *0       0     1|0  0.0% 0.1%       0  271M 59.0M 0|0 0|0   157b   44.7k    2 Aug 29 09:45:14.850 localhost:27017   3.4.2             6331
</code></pre>
</div>

<h3 id="mongotop">mongotop</h3>

<p>racks and reports the current read and write activity of a MongoDB instance, and reports these statistics on a per collection basis.</p>

<h3 id="http-console">Http Console</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>mongo:
  image: mongo:latest
  volumes:
    - /Users/zhidaliao/bak_dir/mongo:/data/db
  ports:
    - "27017:27017"
    - "1000:1000"
    - "28017:28017"
  command: ["mongod", "--rest"]
</code></pre>
</div>

<p>–httpinterface  还可以增加参数进行接口操作</p>

<p>在浏览器中访问 http://localhost:28017/ 可以查看实时信息，不推荐在生产环境中使用，安全性和稳定性。</p>

<h3 id="命令行方式获取">命令行方式获取</h3>

<h4 id="dbcurrentop">db.currentOp()</h4>

<p>显示当前的用户操作。</p>

<h4 id="dbserverstatus">db.serverStatus()</h4>

<p>详细的Mongo服务器信息。主要关注的点</p>

<ul>
  <li>connections 当前连接和可用连接数，听过一个同行介绍过，mongodb最大处理到2000个连接就不行了（要根据你的机器性能和业务来设定），所以设大了没意义。设个合理值的话，到达这个值mongodb就拒绝新的连接请求，避免被太多的连接拖垮。</li>
  <li>indexCounters:btree:misses 索引的不命中数，和hits的比例高就要考虑索引是否正确建立。你看我的”missRatio” : 3.543930204420982e-7，很健康吧。所以miss率在mongostat里面也可以看</li>
</ul>

<h4 id="dbstats">db.stats()</h4>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt; db.stats()
{
	"db" : "yea",
	"collections" : 31,
	"views" : 0,
	"objects" : 45827,
	"avgObjSize" : 345.1348768193423,
	"dataSize" : 15816496,
	"storageSize" : 7372800,
	"numExtents" : 0,
	"indexes" : 54,
	"indexSize" : 2985984,
	"ok" : 1
}
</code></pre>
</div>

<h4 id="dbcollectionstats">db.collection.stats()</h4>

<p>mongo数据库的集合详细信息。</p>

<h4 id="replsetgetstatus">replSetGetStatus</h4>

<p>The replSetGetStatus command (rs.status() from the shell) returns an overview of your replica set’s status.</p>

<h3 id="profiler">profiler</h3>

<p>类似于MySQL的slow log, MongoDB可以监控所有慢的以及不慢的查询。
Profiler默认是关闭的，你可以选择全部开启，或者有慢查询的时候开启。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt; use test
switched to db test
&gt; db.setProfilingLevel(2);
{"was" : 0 , "slowms" : 100, "ok" : 1} 
&gt; db.getProfilingLevel()
2

</code></pre>
</div>

<p><code class="highlighter-rouge">slowms</code>:代表输出 操作大于100毫秒的语句</p>

<p>To change the threshold, pass two parameters to the db.setProfilingLevel() helper in the mongo shell. The first parameter sets the profiling level for the current database, and the second sets the default slow operation threshold for the entire mongod instance.</p>

<p>设置0代表当前的数据库禁止profiler功能，但是这个Mongo实例下的数据库，只要等级是1的，都会使用20ms的配置</p>

<div class="highlighter-rouge"><pre class="highlight"><code>db.setProfilingLevel(0,20)
</code></pre>
</div>

<p>查看Profile日志</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt; db.system.profile.find().sort({$natural:-1})
{"ts" : "Thu Jan 29 2009 15:19:32 GMT-0500 (EST)" , "info" :
"query test.$cmd ntoreturn:1 reslen:66 nscanned:0 query: { profile: 2 } nreturned:1 bytes:50" ,
"millis" : 0} ...
</code></pre>
</div>

<p>3个字段的意义</p>
<ul>
  <li>ts：时间戳</li>
  <li>info：具体的操作</li>
  <li>millis：操作所花时间，毫秒</li>
</ul>

<p><a href="https://docs.mongodb.com/manual/tutorial/manage-the-database-profiler/">Database Profiler¶</a></p>

<h3 id="第三方监测工具">第三方监测工具</h3>

<p>MongoDB Monitoring Service : MongoDB Monitoring Service(MMS)是Mongodb厂商提供的监控服务，可以在网页和Android客户端上监控你的MongoDB状况。</p>

<p>以及其他第三方链接：
<a href="https://docs.mongodb.com/manual/administration/monitoring/#third-party-tools">Third Party Tools</a></p>

<h2 id="性能调优">性能调优</h2>

<p>场景：现实blog的首页-我们希望现实最近发布的10条posts。ts为时间字段。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>db.posts.find().sort({ts:-1}); 
</code></pre>
</div>

<h3 id="创建索引">创建索引</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>db.posts.ensureIndex({ts:1});
</code></pre>
</div>

<p>数据库就可以基于索引信息排序，不会直接查看每个document</p>

<h3 id="限定结果">限定结果</h3>

<p>MongoDB游标返回一组document，我们叫这个为chunks.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>articles = db.posts.find().sort({ts:-1}).limit(10); 
</code></pre>
</div>

<h3 id="查询特定的字段">查询特定的字段</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>db.oauth_clients.find({},{clientId:1,clientSecret:1})
</code></pre>
</div>
<p>如果你选择了要查询的字段，那么返回的就是部分对象。这个对象并不能直接进行更新</p>

<h3 id="读写分离">读写分离</h3>

<p>如果读写都在主节点的话，从节点就一直处在空置状态，这是一种浪费。对于报表或者搜索这种读操作来说完全可以在从节点实现，因此要做的是在 connection string 中设置成 secondarypreferred。</p>

<h3 id="capped-collections">Capped Collections</h3>

<p><a href="https://docs.mongodb.com/manual/core/capped-collections/">Capped Collections¶</a></p>

<p>Capped collections 是固定大小的集合，基于插入的顺序，支持高速的读写文档的操作， Capped collections 工作机制于循环缓存类似:  一旦一个集合填充了他被分配的空间，对于新插入的文档他会覆盖旧文档的空间</p>

<h4 id="表现形式">表现形式</h4>

<h5 id="insertion-order">Insertion Order</h5>

<p>Capped collections 保证插入顺序.所以查询的时候不需要根据索引返回结果，而是通过插入顺序返回,没有索引， capped collections 可以支持高速插入操作，类似于数据库。</p>

<h5 id="自动删除旧文档">自动删除旧文档</h5>

<p>为了给新文档创建空间， capped collections 在集合中自动删除老旧的文档，不需要执行额外的脚本和操作。</p>

<p>举个例子，oplog.rs collection 在副本形式下保存的操作日志就是使用capped collection。以下的潜在的场景：</p>

<ul>
  <li>在高速系统中储存日志，或者在队列形式的事件机制中保持顺序。</li>
  <li>capped collections缓存少量的数据，因为缓存的读操作别写操作更频繁，你可以确保你的集合总是保存在你的工作区（比如内存），或者你能接受一些需要保持顺序的写操作。</li>
</ul>

<h5 id="_id-index">_id Index</h5>

<p>Capped collections have an _id field and an index on the _id field by default.</p>

<h4 id="优缺点">优缺点</h4>

<h5 id="updates">Updates</h5>

<p>如果你准备更新文档，创建了索引所以这些更新操作不需要 经过集合扫描。</p>

<h5 id="document-size">Document Size</h5>

<p>Changed in version 3.2.</p>

<p>文档大小是固定的，如果 更新和替换操作，改变了文档大小，操作将会失败</p>

<h5 id="document-deletion">Document Deletion</h5>

<p>你不能删除文档，只能使用drop()方法删掉集合并重新创建新的内容。</p>

<h5 id="sharding--分片">Sharding  分片</h5>

<p>capped collection 不支持分片操作</p>

<h5 id="query-efficiency">Query Efficiency</h5>

<p>使用自然的排序去获取最近插入集合的元素是更有效率的，类似诶于在日志文件中tail 的命令</p>

<h5 id="函数-out">函数 $out</h5>

<p>$out 管道操作对capped collection无效</p>

<h4 id="程序操作">程序操作</h4>

<h5 id="create-a-capped-collection-创建">Create a Capped Collection 创建</h5>

<p>db.createCollection()命令创建，但是要指定参数预分配空间，单位字节。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>db.createCollection( "log", { capped: true, size: 100000 } )
</code></pre>
</div>
<p>如果空间小于或者等于4096, 集合将会划分出 4096 bytes. MongoDB规划的大小以256的倍数字节扩增</p>

<p>另外，我们可以指定max参数，用来限制最大的文档数量(不是集合的空间大小，而是数量)</p>

<div class="highlighter-rouge"><pre class="highlight"><code>db.createCollection("log", { capped : true, size : 5242880, max : 5000 } )
</code></pre>
</div>

<h4 id="query-a-capped-collection--查询">Query a Capped Collection  查询</h4>

<ul>
  <li>当你使用find函数没有指定排序的时候，mongodb会保证按照插入顺序返回。如果要按照插入顺序的逆序返回结果，find()函数 要紧接着 sort()函数，使用natural参数指定为-1</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>db.cappedCollection.find().sort( { $natural: -1 } )
</code></pre>
</div>

<ul>
  <li>检查是否是Capped 集合</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>db.collection.isCapped()
</code></pre>
</div>

<ul>
  <li>Convert a Collection to Capped ，普通集合转换成 Capped类型</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>db.runCommand({"convertToCapped": "mycoll", size: 100000});
</code></pre>
</div>

<p>This command obtains a global write lock and will block other operations until it has completed.</p>

<ul>
  <li>TTL</li>
</ul>

<p>Setting TTL. These indexes allow you to expire and remove data from normal collections using a special type, based on the value of a date-typed field and a TTL value for the index.
TTL Collections are not compatible with capped collections.</p>

<ul>
  <li>Tailable Cursor</li>
</ul>

<p>You can use a tailable cursor with capped collections. Similar to the Unix tail -f command, the tailable cursor “tails” the end of a capped collection. As new documents are inserted into the capped collection, you can use the tailable cursor to continue retrieving documents.</p>

<p><code class="highlighter-rouge">IMPORTANT</code>
size参数总是必须的，即使你指定了max数量，mongoDb会移除更旧的文档，如果你的集合到达了指定的最大空间限制，在最大的条数限制条数之前。</p>

<h2 id="参考网站">参考网站</h2>

<p><a href="http://xiayuanfeng.iteye.com/blog/999086">MongoDB 优化</a></p>

<p><a href="https://docs.mongodb.com/manual/administration/monitoring/">Monitoring for MongoDB¶</a></p>


                <hr>

                
                <!-- 多说 Share start -->
                </style>
                <div class="ds-share"
                    style="text-align: right"
                    data-thread-key="/2015/01/29/mongo监控及性能调优"
                    data-title="mongo监控及性能调优"
                    data-url="http://localhost:4000/2015/01/29/mongo%E7%9B%91%E6%8E%A7%E5%8F%8A%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/"
                    data-images="http://localhost:4000/img/post-bg-2015.jpg"
                    data-content="监控策略

mongo监控的策略主要有以下两种:


  一系列的工具能够报告实时信息
  数据库命令能够返回当前数据库的详细精确信息


mongost... | 志达的博客 | Paraller's Blog " >
                    <div class="ds-share-inline">
                      <ul  class="ds-share-icons-16">
                        <li data-toggle="ds-share-icons-more"><a class="ds-more" href="#">分享到：</a></li>
                        <li><a class="ds-wechat flat" href="javascript:void(0);" data-service="wechat">微信</a></li>
                        <li><a class="ds-weibo flat" href="javascript:void(0);" data-service="weibo">微博</a></li>
                        <li><a class="ds-douban flat" href="javascript:void(0);" data-service="douban">豆瓣</a></li>
                      </ul>
                      <div class="ds-share-icons-more">
                      </div>
                    </div>
                <hr>
                </div>
                <!-- 多说 Share end-->
                


                <ul class="pager">
                    
                    
                    <li class="next">
                        <a href="/2015/01/29/hello-2015/" data-toggle="tooltip" data-placement="top" title="Welcome to Hux Blog">Next Post &rarr;</a>
                    </li>
                    
                </ul>


                
                <!-- 多说评论框 start -->
                <div class="comment">
                    <div class="ds-thread"
                        data-thread-key="/2015/01/29/mongo监控及性能调优"
                        data-title="mongo监控及性能调优"
                        data-url="http://localhost:4000/2015/01/29/mongo%E7%9B%91%E6%8E%A7%E5%8F%8A%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/" >
                    </div>
                </div>
                <!-- 多说评论框 end -->
                

                

            </div>

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#前端开发" title="前端开发" rel="3">
                                    前端开发
                                </a>
                            
        				
                            
                				<a href="/tags/#JavaScript" title="JavaScript" rel="3">
                                    JavaScript
                                </a>
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#eureka" title="eureka" rel="4">
                                    eureka
                                </a>
                            
        				
                            
                				<a href="/tags/#微服务 & 分布式 & 架构" title="微服务 & 分布式 & 架构" rel="10">
                                    微服务 & 分布式 & 架构
                                </a>
                            
        				
                            
                				<a href="/tags/#安全" title="安全" rel="6">
                                    安全
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
        			</div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">
                    
                        <li><a href="http://www.paraller.com">Paraller's Blog</a></li>
                    
                        <li><a href="#">Foo</a></li>
                    
                        <li><a href="#">Bar</a></li>
                    
                        <li><a href="#">Example Friends</a></li>
                    
                        <li><a href="#">It helps SEO</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>


<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
    // dynamic User by Hux
    var _user = 'blog';

    // duoshuo comment query.
    var duoshuoQuery = {short_name: _user };
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>
<!-- 多说公共JS代码 end -->







<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("http://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    

                    <!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
                    
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/zhida">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="http://weibo.com/zhida">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    


                    
                    <li>
                        <a target="_blank" href="https://www.facebook.com/zhida 2">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/zhida">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Paraller's Blog 2017
                    <br>
                    Theme by <a href="http://huangxuan.me">Hux</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huxpro&repo=huxpro.github.io&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("http://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->

<script>
    // dynamic User by Hux
    var _gaId = 'UA-106159397-1';
    var _gaDomain = 'www.paraller.com';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>



<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = '29bd9c56c7cf57524dd2340ce2d7da2e';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>




<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
